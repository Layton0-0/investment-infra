# AWS (엣지 계층): Nginx, Frontend
# FRONTEND_TAG, REGISTRY 환경 변수로 이미지 태그 주입. REGISTRY는 ghcr.io/OWNER 형식.
# Nginx는 Backend(Oracle 2)로 /api 프록시 설정 필요 (nginx/conf.d 또는 nginx.conf).
services:
  frontend:
    image: ${REGISTRY:-ghcr.io}/investment-frontend:${FRONTEND_TAG:-latest}
    container_name: investment-frontend
    restart: unless-stopped
    networks:
      - investment-network

  nginx:
    image: nginx:alpine
    container_name: investment-nginx
    restart: unless-stopped
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./nginx/conf.d:/etc/nginx/conf.d:ro
    depends_on:
      - frontend
    networks:
      - investment-network

networks:
  investment-network:
    driver: bridge
